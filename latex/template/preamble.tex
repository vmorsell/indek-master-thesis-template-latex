% Reference style
\usepackage[
    backend=biber,
	citestyle=ieee,
    maxbibnames=6,
    minbibnames=1,
    giveninits=true,
]{biblatex}
    
% Specify the margins.
\usepackage[a4paper, top=30mm, left=36mm, right=18mm, bottom=30mm, headheight=1mm, headsep=15mm, asymmetric]{geometry}

%\usepackage{eso-pic}					% Packages for layout and graphics 
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{tocloft}                    % customize table of contents
\usepackage{etoc} 						% Separate tocs for appendix and the rest
\usepackage[titletoc,title]{appendix}
\usepackage{wrapfig}                    % Wrap text around figures
\usepackage{booktabs}					% Table formatting
\usepackage{titlesec}                   % Customize headers
\usepackage{fancyhdr}					% Setting the style for header and footer.
\usepackage{tabularx}
\usepackage{multirow}                   % For better tables 
\usepackage[hidelinks]{hyperref}		% Clickable links
\usepackage{nameref}					% References with names
\usepackage{ragged2e}                   % Better text alignment
\usepackage{lipsum}                     % Lipsum text

\usepackage{amsmath}

\usepackage{caption}                % customize caption labels and text
\usepackage{fontspec}               % select font by name
\usepackage{sectsty}                % customize font size, family, and style of section headings
\usepackage{csquotes}               % needed by babel/polyglossia

% Use 1.5 row spacing
\usepackage{setspace}
\onehalfspacing

% Set space between items in lists
\usepackage{enumitem}
\setlist[itemize]{itemsep=0pt,leftmargin=*}
\setlist[enumerate]{itemsep=0pt,leftmargin=*}

% Specify fonts
\setmainfont{Georgia}
\setsansfont{Arial}
\newfontfamily\footerfont{Georgia}

% Avoid hyphenation
% Try to lower the values if you get lines with 4-5 words and wide spaces inbetween
\hyphenpenalty=9999
\exhyphenpenalty=9999

\chapterfont{\RaggedRight\sffamily\Large}
\sectionfont{\RaggedRight\sffamily\large}
\subsectionfont{\RaggedRight\sffamily\normalsize}
\subsubsectionfont{\RaggedRight\sffamily\normalsize}
\renewcommand{\familydefault}{\rmdefault}

% Style Contents
\renewcommand*\cfttoctitlefont{\Large\bf\sffamily}      % Title
\renewcommand\cftchapfont{\large\bf\sffamily}           % Chapter
\renewcommand\cftchappagefont{\large\bf\sffamily}       % Chapter page
\renewcommand\cftsecfont{\normalsize\bf\sffamily}       % Section
\renewcommand\cftsecpagefont{\normalsize\bf\sffamily}   % Section page
\renewcommand\cftsubsecfont{\normalsize\sffamily}       % Subsection
\renewcommand\cftsubsecpagefont{\normalsize\sffamily}   % Subsection page

% Style List of Figures
\renewcommand*\cftloftitlefont{\Large\bf\sffamily}      % Title
\renewcommand\cftfigfont{\normalsize\sffamily}          % Entry
\renewcommand\cftfigpagefont{\normalsize\sffamily}      % Entry page

% Style List of Tables
\renewcommand*\cftlottitlefont{\Large\bf\sffamily}      % Title
\renewcommand\cfttabfont{\normalsize\sffamily}          % Entry
\renewcommand\cfttabpagefont{\normalsize\sffamily}      % Entry page

% Define table column type for centered paragraph
\newcolumntype{C}[1]{>{\centering\arraybackslash}p{#1}}

% Format captions in wrapped figures
\newfontfamily\arialcaptionfont{Arial}[SizeFeatures={Size=10}]
\DeclareCaptionFont{caption}{\arialcaptionfont}
\captionsetup{
    font=caption,
    format=hang,
    singlelinecheck=off,
    justification=justified,
}

% Style the header and footer
\fancyhf{}
\fancyhead[LE]{\scriptsize\sffamily \thepage \quad|\quad \MakeUppercase\leftmark} % LE: Left side of Even pages
% Configuration for odd (right) pages: "Chapter Title | pageNumber"
\fancyhead[RO]{\scriptsize\sffamily \MakeUppercase\leftmark \quad|\quad \thepage} % RO: Right side of Odd pages
% Optional: Customize the appearance of chapter titles in the header
\renewcommand{\chaptermark}[1]{%
  \markboth{#1}{}%
}
\renewcommand{\headrulewidth}{0pt}

% Adjust chapter heading formatting to include chapter number
\titleformat{\chapter}[block] % 'block' style for the title
  {\sffamily\Large\bfseries} % Font styling
  {\thechapter\ } % Label for the chapter number
  {25pt} % Separation between label and title
  {} % Before the title code
  
% Add extra margin before the title of a new chapter
\titlespacing*{\chapter}
  {0pt} % Left margin
  {20mm} % Top margin
  {20pt} % Bottom margin


\fancypagestyle{plain}{
    \fancyhf{}
    % Add left-adjusted header text "pageNumber | CHAPTER TITLE" to even pages
    % LE: Left side of Even pages
    \fancyhead[LE]{\scriptsize\sffamily \thepage \quad|\quad \MakeUppercase\leftmark}
    
    % Add right-adjusted header text "CHAPTER TITLE | pageNumber" to odd pages
    % RO: Right side of Odd pages
    \fancyhead[RO]{\scriptsize\sffamily \MakeUppercase\leftmark \quad|\quad \thepage}
    
    % Optional: Customize the appearance of chapter titles in the header
    \renewcommand{\chaptermark}[1]{%
      \markboth{##1}{}%
    }
    \renewcommand{\headrulewidth}{0pt}
}

\fancypagestyle{none}{
  \fancyhf{}
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0pt}
}

\pagestyle{fancy}

% Languages
\usepackage[english,swedish]{babel} % The last is default
\usepackage{iflang}

% Define bibliography file
\addbibresource{references.bib}

% Make Swedish titles comply with instructions
\addto\captionsswedish{
    \renewcommand{\contentsname}{Innehållsförteckning}
    \renewcommand{\listfigurename}{Figurförteckning}
    \renewcommand{\listtablename}{Tabellförteckning}
}

% Custom unnumbered chapter that ensures the chapter title in the header is updated
\newcommand{\unnumberedchapter}[1]{
    \chapter*{#1}
    \markboth{#1}{#1}
}